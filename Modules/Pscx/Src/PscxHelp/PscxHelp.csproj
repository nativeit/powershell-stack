<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003" ToolsVersion="4.0">
  <!-- NOTE: THIS IS A *NOT* A C# PROJECT. IT IS A CUSTOM MSBUILD PROJECT FILE FOR BUILDING HELP -->
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{5FC267A9-D477-41B9-B2AA-BF4A1A029940}</ProjectGuid>
    <OutputType>Library</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>Pscx.Help</RootNamespace>
    <AssemblyName>THIS_IS_NOT_A_C#_PROJECT_DO_NOT_EDIT_HERE</AssemblyName>
    <ProjectDir>$(MSBuildProjectDirectory)\</ProjectDir>
    <OutputPath>Output\</OutputPath>
    <FileUpgradeFlags>
    </FileUpgradeFlags>
    <OldToolsVersion>3.5</OldToolsVersion>
    <UpgradeBackupLocation>
    </UpgradeBackupLocation>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|AnyCPU' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>$(OutputPath)</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|AnyCPU' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>$(OutputPath)</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
  </PropertyGroup>
  <PropertyGroup Condition="'$(Configuration)|$(Platform)' == 'Release-Signed|AnyCPU'">
    <OutputPath>$(OutputPath)</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <Optimize>true</Optimize>
    <DebugType>pdbonly</DebugType>
    <PlatformTarget>AnyCPU</PlatformTarget>
    <ErrorReport>prompt</ErrorReport>
    <CodeAnalysisRuleSet>AllRules.ruleset</CodeAnalysisRuleSet>
  </PropertyGroup>
  <ItemGroup>
    <Template Include="about_Pscx_header.txt" />
    <Template Include="about_Pscx_footer.txt" />
    <None Include="Scripts\GenerateAboutPsxcHelpTxt.ps1" />
    <None Include="Scripts\GeneratePscxHelpXml.ps1" />
    <None Include="Scripts\New-HelpSkeleton.ps1" />
    <None Include="Transformations\Maml.xslt" />
    <None Include="Transformations\ParameterStats.xslt" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Help\ConvertFromBase64.xml" />
    <None Include="Help\ConvertToBase64.xml" />
    <None Include="Help\ConvertToMacOs9LineEnding.xml" />
    <None Include="Help\ConvertToUnixLineEnding.xml" />
    <None Include="Help\ConvertToWindowsLineEnding.xml" />
    <None Include="Help\ConvertXml.xml" />
    <None Include="Help\DisconnectTerminalSession.xml" />
    <None Include="Help\ExportBitmap.xml" />
    <None Include="Help\FormatByte.xml" />
    <None Include="Help\FormatPscxHex.xml" />
    <None Include="Help\FormatXml.xml" />
    <None Include="Help\GetADObject.xml" />
    <None Include="Help\GetPscxClipboard.xml" />
    <None Include="Help\GetDhcpServer.xml" />
    <None Include="Help\GetDomainController.xml" />
    <None Include="Help\GetFileVersionInfo.xml" />
    <None Include="Help\GetForegroundWindow.xml" />
    <None Include="Help\GetHash.xml" />
    <None Include="Help\GetMountPoint.xml" />
    <None Include="Help\GetPEHeader.xml" />
    <None Include="Help\GetPrivilege.xml" />
    <None Include="Help\GetPSSnapinHelp.xml" />
    <None Include="Help\GetRandom.xml" />
    <None Include="Help\GetReparsePoint.xml" />
    <None Include="Help\GetShortPath.xml" />
    <None Include="Help\GetTerminalSession.xml" />
    <None Include="Help\ImportBitmap.xml" />
    <None Include="Help\JoinPscxString.xml" />
    <None Include="Help\NewHardlink.xml" />
    <None Include="Help\NewJunction.xml" />
    <None Include="Help\NewShortcut.xml" />
    <None Include="Help\NewSymlink.xml" />
    <None Include="Help\OutPscxClipboard.xml" />
    <None Include="Help\PingHost.xml" />
    <None Include="Help\RemoveMountPoint.xml" />
    <None Include="Help\RemoveReparsePoint.xml" />
    <None Include="Help\SetBitmapSize.xml" />
    <None Include="Help\ResolveAssembly.xml" />
    <None Include="Help\ResolveHost.xml" />
    <None Include="Help\SelectXml.xml" />
    <None Include="Help\SendSmtpMail.xml" />
    <None Include="Help\SetPscxClipboard.xml" />
    <None Include="Help\SetFileTime.xml" />
    <None Include="Help\SetForegroundWindow.xml" />
    <None Include="Help\SetPrivilege.xml" />
    <None Include="Help\SetVolumeLabel.xml" />
    <None Include="Help\SplitString.xml" />
    <None Include="Help\StartProcess.xml" />
    <None Include="Help\StopTerminalSession.xml" />
    <None Include="Help\TestAssembly.xml" />
    <None Include="Help\TestXml.xml" />
    <None Include="Help\WriteBZip2.xml" />
    <None Include="Help\WritePscxClipboard.xml" />
    <None Include="Help\WriteGZip.xml" />
    <None Include="Help\WriteTar.xml" />
    <None Include="Help\WriteZip.xml" />
    <None Include="Help\AddPathVariable.xml" />
    <None Include="Help\ClearMSMQueue.xml" />
    <None Include="Help\NewGenericObject.xml" />
    <None Include="Help\ExpandPscxArchive.xml" />
    <None Include="Help\GetAdoConnection.xml" />
    <None Include="Help\GetAdoDataProvider.xml" />
    <None Include="Help\GetDriveInfo.xml" />
    <None Include="Help\GetExportedType.xml" />
    <None Include="Help\GetHttpResource.xml" />
    <None Include="Help\GetMSMQueue.xml" />
    <None Include="Help\GetOleDbData.xml" />
    <None Include="Help\GetOleDbDataSet.xml" />
    <None Include="Help\GetOpticalDriveInfo.xml" />
    <None Include="Help\GetPathVariable.xml" />
    <None Include="Help\GetSqlData.xml" />
    <None Include="Help\GetSqlDataSet.xml" />
    <None Include="Help\GetWebService.xml" />
    <None Include="Help\InvokeAdoCommand.xml" />
    <None Include="Help\InvokeApartment.xml" />
    <None Include="Help\InvokeOleDbCommand.xml" />
    <None Include="Help\InvokeSqlCommand.xml" />
    <None Include="Help\NewMSMQueue.xml" />
    <None Include="Help\PopEnvironmentBlock.xml" />
    <None Include="Help\PushEnvironmentBlock.xml" />
    <None Include="Help\ReadPscxArchive.xml" />
    <None Include="Help\ReceiveMSMQueue.xml" />
    <None Include="Help\SendMSMQueue.xml" />
    <None Include="Help\SetPathVariable.xml" />
    <None Include="Help\SkipObject.xml" />
    <None Include="Help\TestMSMQueue.xml" />
    <None Include="Help\TestPscxPath.xml" />
    <None Include="Help\TestUserGroupMembership.xml" />
    <None Include="Help\GetEnvironmentBlock.xml" />
    <None Include="Help\GetTypeName.xml" />
    <None Include="Help\GetPscxUptime.xml" />
    <None Include="Help\GetFileTail.xml" />
    <None Include="Help\GetLoremIpsum.xml" />
    <None Include="Help\TestScript.xml" />
    <None Include="Help\ConvertToMetric.xml" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Provider_AssemblyCache.xml" />
    <None Include="Provider_DirectoryServices.xml" />
    <None Include="Provider_Feedstore.xml" />
    <None Include="Provider_template.xml" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Help\TestAlternateDataStream.xml" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Help\GetRunningObject.xml" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Help\EditFile.xml" />
  </ItemGroup>
  <Target Name="Prep">
    <MakeDir Directories="$(ProjectDir)$(OutputPath)" />
  </Target>
  <Target Name="BuildPscxXmlHelp">
    <Exec Command="PowerShell.exe -NoProfile -ExecutionPolicy Unrestricted -NonInteractive -File .\Scripts\GeneratePscxHelpXml.ps1 .\$(OutputPath) $(ProjectDir)Help -Configuration $(Configuration)" WorkingDirectory="$(ProjectDir)" Outputs="$(ProjectDir)$(OutputPath)Pscx.dll-Help.xml">
      <Output TaskParameter="Outputs" ItemName="Content" />
    </Exec>
  </Target>
  <Target Name="BuildAboutHelp" DependsOnTargets="BuildPscxXmlHelp">
    <Exec Command="PowerShell.exe -NoProfile -ExecutionPolicy Unrestricted -NonInteractive -File .\Scripts\GenerateAboutPsxcHelpTxt.ps1 .\$(OutputPath) -Configuration $(Configuration)" WorkingDirectory="$(ProjectDir)" Outputs="$(ProjectDir)$(OutputPath)about_Pscx.help.txt">
      <Output TaskParameter="Outputs" ItemName="Content" />
    </Exec>
  </Target>
  <Target Name="PostBuild">
    <Copy SourceFiles="@(Content)" DestinationFolder="$(ProjectDir)..\Pscx\bin\$(Configuration)" />
  </Target>
  <Target Name="Build" DependsOnTargets="Prep;BuildPscxXmlHelp;BuildAboutHelp;PostBuild" />
  <Target Name="Clean">
    <RemoveDir Directories="$(ProjectDir)$(OutputPath);$(ProjectDir)obj" />
  </Target>
  <Target Name="Rebuild" DependsOnTargets="Clean;Build" />
</Project>